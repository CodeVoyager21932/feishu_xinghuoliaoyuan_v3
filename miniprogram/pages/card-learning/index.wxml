<!-- å¡ç‰‡å­¦ä¹ é¡µé¢ -->
<view class="card-learning-page">
  <!-- é¡¶éƒ¨è¿›åº¦ -->
  <view class="progress-bar">
    <view class="progress-info">
      <text class="progress-text">ä»Šæ—¥å­¦ä¹ ï¼š{{todayCount}}/{{totalCount}}</text>
      <text class="progress-percent">{{progressPercent}}%</text>
    </view>
    <view class="progress-track">
      <view class="progress-fill" style="width: {{progressPercent}}%"></view>
    </view>
  </view>

  <!-- å¡ç‰‡å®¹å™¨ -->
  <view class="card-container">
    <view class="card-stack">
      <!-- å½“å‰å¡ç‰‡ -->
      <view 
        class="card {{flipped ? 'flipped' : ''}} {{swiping ? 'swiping' : ''}}"
        style="transform: translateX({{swipeX}}px) rotate({{swipeRotate}}deg)"
        wx:if="{{currentCard}}"
        bindtouchstart="onTouchStart"
        bindtouchmove="onTouchMove"
        bindtouchend="onTouchEnd"
        bindtap="onCardTap"
      >
        <!-- æ­£é¢ -->
        <view class="card-front">
          <view class="card-badge">{{currentCard.category}}</view>
          <image class="card-image" src="{{currentCard.front_image}}" mode="aspectFill" />
          <view class="card-title">{{currentCard.front_title}}</view>
          <view class="flip-hint">
            <text>ğŸ‘† ç‚¹å‡»ç¿»è½¬æŸ¥çœ‹è¯¦æƒ…</text>
          </view>
        </view>

        <!-- èƒŒé¢ -->
        <view class="card-back">
          <view class="card-content">
            <text class="content-text">{{currentCard.back_content}}</text>
          </view>
          <view class="card-keywords">
            <view class="keyword" wx:for="{{currentCard.back_keywords}}" wx:key="index">
              <text>{{item}}</text>
            </view>
          </view>
          <button class="ai-detail-btn" bindtap="askAI" catchtap="stopPropagation">
            <text>ğŸ¤– AIè¯¦è§£</text>
          </button>
        </view>

        <!-- æ»‘åŠ¨æç¤º -->
        <view class="swipe-hint left {{swipeDirection === 'left' ? 'show' : ''}}">
          <text>âŒ</text>
          <text>å¾…å¤ä¹ </text>
        </view>
        <view class="swipe-hint right {{swipeDirection === 'right' ? 'show' : ''}}">
          <text>âœ…</text>
          <text>å·²æŒæ¡</text>
        </view>
      </view>

      <!-- ä¸‹ä¸€å¼ å¡ç‰‡é¢„è§ˆ -->
      <view class="card next-card" wx:if="{{nextCard}}">
        <view class="card-front">
          <image class="card-image" src="{{nextCard.front_image}}" mode="aspectFill" />
          <view class="card-title">{{nextCard.front_title}}</view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{!currentCard && !isLoading}}">
      <text class="empty-icon">ğŸ‰</text>
      <text class="empty-title">ä»Šæ—¥å­¦ä¹ å®Œæˆï¼</text>
      <text class="empty-desc">ä½ å·²ç»å®Œæˆäº†ä»Šå¤©çš„å­¦ä¹ ä»»åŠ¡</text>
      <button class="review-btn" bindtap="startReview">
        <text>å¼€å§‹å¤ä¹ </text>
      </button>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
  <view class="action-buttons" wx:if="{{currentCard}}">
    <view class="action-btn review-btn-bottom" bindtap="markAsReview">
      <text class="btn-icon">âŒ</text>
      <text class="btn-text">å¾…å¤ä¹ </text>
    </view>
    <view class="action-btn flip-btn" bindtap="toggleFlip">
      <text class="btn-icon">ğŸ”„</text>
      <text class="btn-text">ç¿»è½¬</text>
    </view>
    <view class="action-btn master-btn" bindtap="markAsMastered">
      <text class="btn-icon">âœ…</text>
      <text class="btn-text">å·²æŒæ¡</text>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-panel">
    <view class="stat-item">
      <text class="stat-value">{{stats.mastered}}</text>
      <text class="stat-label">å·²æŒæ¡</text>
    </view>
    <view class="stat-item">
      <text class="stat-value">{{stats.reviewing}}</text>
      <text class="stat-label">å¾…å¤ä¹ </text>
    </view>
    <view class="stat-item">
      <text class="stat-value">{{stats.remaining}}</text>
      <text class="stat-label">æœªå­¦ä¹ </text>
    </view>
  </view>

  <!-- åŠ è½½æç¤º -->
  <view class="loading" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>
