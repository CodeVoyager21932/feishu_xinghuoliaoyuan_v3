<!-- çŸ¥è¯†å›¾è°±é¡µé¢ -->
<view class="graph-page">
  <!-- é¡¶éƒ¨ç­›é€‰æ  -->
  <view class="filter-bar">
    <view 
      class="filter-btn {{filter === 'all' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-filter="all"
    >
      å…¨éƒ¨
    </view>
    <view 
      class="filter-btn {{filter === 'revolution' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-filter="revolution"
    >
      é©å‘½æ—¶æœŸ
    </view>
    <view 
      class="filter-btn {{filter === 'construction' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-filter="construction"
    >
      å»ºè®¾æ—¶æœŸ
    </view>
    <view 
      class="filter-btn {{filter === 'reform' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-filter="reform"
    >
      æ”¹é©æ—¶æœŸ
    </view>
  </view>

  <!-- æ—¶é—´è½´åˆ—è¡¨è§†å›¾ï¼ˆä¸´æ—¶æ›¿ä»£Canvasï¼‰ -->
  <scroll-view class="timeline-view" scroll-y>
    <view class="timeline-container">
      <view 
        class="timeline-item"
        wx:for="{{filteredNodes}}"
        wx:key="id"
        bindtap="onNodeClick"
        data-node="{{item}}"
      >
        <view class="timeline-dot"></view>
        <view class="timeline-content">
          <view class="node-year">{{item.year}}å¹´</view>
          <view class="node-label">{{item.label}}</view>
          <view class="node-desc">{{item.description}}</view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- æ“ä½œæç¤º -->
  <view class="tips">
    <text>ğŸ’¡ ç‚¹å‡»äº‹ä»¶æŸ¥çœ‹è¯¦æƒ…</text>
  </view>

  <!-- è¯¦æƒ…å¡ç‰‡ï¼ˆåº•éƒ¨å¼¹å‡ºï¼‰ -->
  <view class="detail-card {{showDetail ? 'show' : ''}}" catchtap="hideDetail">
    <view class="card-content" catchtap="stopPropagation">
      <view class="card-header">
        <text class="card-title">{{selectedNode.label}}</text>
        <text class="card-close" bindtap="hideDetail">Ã—</text>
      </view>
      
      <view class="card-body">
        <view class="info-row" wx:if="{{selectedNode.date}}">
          <text class="info-label">æ—¶é—´ï¼š</text>
          <text class="info-value">{{selectedNode.date}}</text>
        </view>
        
        <view class="info-row" wx:if="{{selectedNode.location}}">
          <text class="info-label">åœ°ç‚¹ï¼š</text>
          <text class="info-value">{{selectedNode.location}}</text>
        </view>
        
        <view class="info-row" wx:if="{{selectedNode.description}}">
          <text class="info-label">ç®€ä»‹ï¼š</text>
          <text class="info-value">{{selectedNode.description}}</text>
        </view>
      </view>
      
      <view class="card-footer">
        <button class="ai-btn" bindtap="askAI">
          <text>ğŸ¤– AIè¯¦è§£</text>
        </button>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æç¤º -->
  <view class="loading" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>
